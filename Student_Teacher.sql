USE cafy21573;

DROP TABLE STUDENT_TEACHER;
DROP TABLE TEACHER;
DROP TABLE STUDENT1;

CREATE TABLE STUDENT1(ROLLNO INT PRIMARY KEY, NAME VARCHAR(30), MARKS INT);
CREATE TABLE TEACHER(TNO INT PRIMARY KEY, TNAME VARCHAR(30));
CREATE TABLE STUDENT_TEACHER(ROLLNO INT, FOREIGN KEY(ROLLNO) REFERENCES STUDENT1(ROLLNO), TNO INT, FOREIGN KEY(TNO) REFERENCES TEACHER(TNO), CLASS VARCHAR(30), SUBJECT VARCHAR(30));

DESC STUDENT1;
DESC TEACHER;
DESC STUDENT_TEACHER;

INSERT INTO STUDENT1(ROLLNO, NAME, MARKS) VALUES(1, 'ADITYA', 65);
INSERT INTO STUDENT1(ROLLNO, NAME, MARKS) VALUES(2, 'ABHINAV', 70);
INSERT INTO STUDENT1(ROLLNO, NAME, MARKS) VALUES(3, 'ANAMIKA', 75);
INSERT INTO STUDENT1(ROLLNO, NAME, MARKS) VALUES(4, 'PIYUSH', 80);
INSERT INTO STUDENT1(ROLLNO, NAME, MARKS) VALUES(5, 'ARPITA', 70);

INSERT INTO TEACHER(TNO, TNAME) VALUES(101,'Mr.XXX');
INSERT INTO TEACHER(TNO, TNAME) VALUES(102,'Mr.QQQ');
INSERT INTO TEACHER(TNO, TNAME) VALUES(103,'Mr.YYY');
INSERT INTO TEACHER(TNO, TNAME) VALUES(104,'Mr.MMM');
INSERT INTO TEACHER(TNO, TNAME) VALUES(105,'Mr.ZZZ');

INSERT STUDENT_TEACHER(ROLLNO, TNO, CLASS, SUBJECT) VALUES(1, 101, 'TY', 'PYTHON');
INSERT STUDENT_TEACHER(ROLLNO, TNO, CLASS, SUBJECT) VALUES(2, 102, 'SY', 'DBMS');
INSERT STUDENT_TEACHER(ROLLNO, TNO, CLASS, SUBJECT) VALUES(3, 103, 'FY', 'OS');
INSERT STUDENT_TEACHER(ROLLNO, TNO, CLASS, SUBJECT) VALUES(4, 104, 'TY', 'DBMS');
INSERT STUDENT_TEACHER(ROLLNO, TNO, CLASS, SUBJECT) VALUES(5, 105, 'FY', 'JAVA');
INSERT STUDENT_TEACHER(ROLLNO, TNO, CLASS, SUBJECT) VALUES(4, 103, 'TY', 'JAVA');
INSERT STUDENT_TEACHER(ROLLNO, TNO, CLASS, SUBJECT) VALUES(1, 104, 'TY', 'WEB TECHNOLOGY');
INSERT STUDENT_TEACHER(ROLLNO, TNO, CLASS, SUBJECT) VALUES(1, 101, 'TY', 'RDBMS');
INSERT STUDENT_TEACHER(ROLLNO, TNO, CLASS, SUBJECT) VALUES(5, 101, 'FY', 'ADVANCE PYTHON');
INSERT STUDENT_TEACHER(ROLLNO, TNO, CLASS, SUBJECT) VALUES(2, 102, 'SY', 'JAVA');
INSERT STUDENT_TEACHER(ROLLNO, TNO, CLASS, SUBJECT) VALUES(3, 105, 'FY', 'PYTHON');

SELECT * FROM STUDENT1;
SELECT * FROM TEACHER;
SELECT * FROM STUDENT_TEACHER;

SELECT NAME FROM STUDENT1 S, TEACHER T, STUDENT_TEACHER ST 
WHERE S.ROLLNO = ST.ROLLNO AND T.TNO = ST.TNO AND TNAME = "MR.XXX" HAVING COUNT(SUBJECT)>2;

SELECT S.* FROM STUDENT1 S, TEACHER T, STUDENT_TEACHER ST 
WHERE S.ROLLNO = ST.ROLLNO AND T.TNO = ST.TNO AND TNAME = "MR.YYY" AND CLASS = "TY" HAVING MARKS>=75;

SELECT TNAME FROM TEACHER T, STUDENT_TEACHER ST 
WHERE T.TNO = ST.TNO AND SUBJECT = "PYTHON";

SELECT CLASS, COUNT(DISTINCT (S.ROLLNO))FROM STUDENT1 S, STUDENT_TEACHER ST
WHERE S.ROLLNO = ST.ROLLNO GROUP BY CLASS;