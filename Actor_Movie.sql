USE cafy21573;

DROP TABLE MOVIE_ACTOR;
DROP TABLE ACTOR;
DROP TABLE MOVIE;

CREATE TABLE MOVIE(MOVNO INT PRIMARY KEY, MVNAME VARCHAR(30), RELESEYEAR INT);
CREATE TABLE ACTOR(ACTNO INT PRIMARY KEY, ACTNAME VARCHAR(30));
CREATE TABLE MOVIE_ACTOR(MOVNO INT, FOREIGN KEY(MOVNO) REFERENCES MOVIE(MOVNO), ACTNO INT, FOREIGN KEY(ACTNO) REFERENCES ACTOR(ACTNO));

DESC MOVIE;
DESC ACTOR;
DESC MOVIE_ACTOR;

INSERT INTO MOVIE(MOVNO, MVNAME, RELESEYEAR) VALUES(1, 'KALIA', 1989);
INSERT INTO MOVIE(MOVNO, MVNAME, RELESEYEAR) VALUES(2, 'DDLJ', 2000);
INSERT INTO MOVIE(MOVNO, MVNAME, RELESEYEAR) VALUES(3, 'HAHK', 1987);
INSERT INTO MOVIE(MOVNO, MVNAME, RELESEYEAR) VALUES(4, 'SATHIYA', 1990);
INSERT INTO MOVIE(MOVNO, MVNAME, RELESEYEAR) VALUES(5, 'FORCE', 2010);

INSERT INTO ACTOR(ACTNO, ACTNAME) VALUES(10, 'AMITABH');
INSERT INTO ACTOR(ACTNO, ACTNAME) VALUES(11, 'R MADHAVAN');
INSERT INTO ACTOR(ACTNO, ACTNAME) VALUES(12, 'SALMAN KHAN');
INSERT INTO ACTOR(ACTNO, ACTNAME) VALUES(13, 'VIVEK OBROY');
INSERT INTO ACTOR(ACTNO, ACTNAME) VALUES(14, 'JOHN ABRAHAM');
INSERT INTO ACTOR(ACTNO, ACTNAME) VALUES(15, 'DHARMENDRA');

INSERT INTO MOVIE_ACTOR(MOVNO, ACTNO) VALUES(1, 10);
INSERT INTO MOVIE_ACTOR(MOVNO, ACTNO) VALUES(1, 11);
INSERT INTO MOVIE_ACTOR(MOVNO, ACTNO) VALUES(1, 12);
INSERT INTO MOVIE_ACTOR(MOVNO, ACTNO) VALUES(1, 13);
INSERT INTO MOVIE_ACTOR(MOVNO, ACTNO) VALUES(1, 14);
INSERT INTO MOVIE_ACTOR(MOVNO, ACTNO) VALUES(1, 15);
INSERT INTO MOVIE_ACTOR(MOVNO, ACTNO) VALUES(2, 10);
INSERT INTO MOVIE_ACTOR(MOVNO, ACTNO) VALUES(2, 11);
INSERT INTO MOVIE_ACTOR(MOVNO, ACTNO) VALUES(2, 12);
INSERT INTO MOVIE_ACTOR(MOVNO, ACTNO) VALUES(2, 13);
INSERT INTO MOVIE_ACTOR(MOVNO, ACTNO) VALUES(2, 14);
INSERT INTO MOVIE_ACTOR(MOVNO, ACTNO) VALUES(2, 15);
INSERT INTO MOVIE_ACTOR(MOVNO, ACTNO) VALUES(3, 13);
INSERT INTO MOVIE_ACTOR(MOVNO, ACTNO) VALUES(4, 14);
INSERT INTO MOVIE_ACTOR(MOVNO, ACTNO) VALUES(5, 15);

SELECT * FROM MOVIE;
SELECT * FROM ACTOR;
SELECT * FROM MOVIE_ACTOR;

SELECT MVNAME FROM MOVIE 
WHERE MOVNO IN (SELECT MOVNO FROM MOVIE_ACTOR 
WHERE ACTNO IN (SELECT ACTNO FROM ACTOR 
WHERE ACTNAME = "AMITABH" AND MVNAME LIKE "K%" AND 1965<RELESEYEAR<1980));

SELECT M.MVNAME FROM MOVIE M, ACTOR A, MOVIE_ACTOR MV
WHERE M.MOVNO = MV.MOVNO AND A.ACTNO = MV.ACTNO AND ACTNAME = "AMITABH" AND MVNAME LIKE "K%" AND 1965<RELESEYEAR<1980;

SELECT ACTOR.ACTNAME, MOVIE.MVNAME, MOVIE.RELESEYEAR FROM MOVIE 
INNER JOIN MOVIE_ACTOR ON MOVIE.MOVNO = MOVIE_ACTOR.MOVNO 
INNER JOIN ACTOR ON MOVIE_ACTOR.ACTNO = ACTOR.ACTNO ORDER BY ACTNAME;

SELECT A.ACTNAME, M.MVNAME, M.RELESEYEAR FROM MOVIE M, ACTOR A, MOVIE_ACTOR MA
WHERE M.MOVNO = MA.MOVNO AND MA.ACTNO = A.ACTNO ORDER BY ACTNAME;

SELECT COUNT(M.MOVNO) FROM MOVIE M, ACTOR A, MOVIE_ACTOR MA
WHERE M.MOVNO = MA.MOVNO AND A.ACTNO = MA.ACTNO AND A.ACTNAME = "SALMAN KHAN"; 

SELECT M.MOVNO, M.MVNAME, M.RELESEYEAR FROM MOVIE M, MOVIE_ACTOR MV, ACTOR A
WHERE M.MOVNO = MV.MOVNO AND A.ACTNO = MV.ACTNO GROUP BY MV.MOVNO HAVING COUNT(MV.ACTNO)>5; 