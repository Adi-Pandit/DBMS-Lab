USE cafy21573;

DROP TABLE GAME_PLAYERS;
DROP TABLE PLAYERS;
DROP TABLE GAME;

CREATE TABLE GAME(GNAME VARCHAR(20) PRIMARY KEY, NO_OF_PLAYERS INT, CAPTAIN_NAME VARCHAR(20));
CREATE TABLE PLAYERS(PNAME VARCHAR(20) PRIMARY KEY, ADDRESS VARCHAR(20), CLUBNAME VARCHAR(20));
CREATE TABLE GAME_PLAYERS(GNAME VARCHAR(20), FOREIGN KEY(GNAME) REFERENCES GAME(GNAME), PNAME VARCHAR(20), FOREIGN KEY(PNAME) REFERENCES PLAYERS(PNAME), COACH_NAME VARCHAR(20));

DESC GAME;
DESC PLAYERS;
DESC GAME_PLAYERS;

INSERT INTO GAME(GNAME,NO_OF_PLAYERS,CAPTAIN_NAME) VALUES('FOOTBALL',11,'ADITYA');
INSERT INTO GAME(GNAME,NO_OF_PLAYERS,CAPTAIN_NAME) VALUES('CRICKET',10,'PIYUSH');
INSERT INTO GAME(GNAME,NO_OF_PLAYERS,CAPTAIN_NAME) VALUES('VOLLEYBALL',6,'ATHARAV');
INSERT INTO GAME(GNAME,NO_OF_PLAYERS,CAPTAIN_NAME) VALUES('BASKETBALL',7,'ABHINAV');
INSERT INTO GAME(GNAME,NO_OF_PLAYERS,CAPTAIN_NAME) VALUES('BASEBALL',8,'NIRMAL');

INSERT INTO PLAYERS(PNAME,ADDRESS,CLUBNAME) VALUES('RAJU','PUNE','XYZW');
INSERT INTO PLAYERS(PNAME,ADDRESS,CLUBNAME) VALUES('SANJU','PUNE','MVNB');
INSERT INTO PLAYERS(PNAME,ADDRESS,CLUBNAME) VALUES('VIJAY','CHINCHWAD','BMVN');
INSERT INTO PLAYERS(PNAME,ADDRESS,CLUBNAME) VALUES('KEDAR','SLOAPUR','FHGY');
INSERT INTO PLAYERS(PNAME,ADDRESS,CLUBNAME) VALUES('SIDDHESH','PUNE','TREW');
INSERT INTO PLAYERS(PNAME,ADDRESS,CLUBNAME) VALUES('SHOUNAK','PUNE','EWRT');
INSERT INTO PLAYERS(PNAME,ADDRESS,CLUBNAME) VALUES('SHUBHANKAR','PUNE','CVDF');
INSERT INTO PLAYERS(PNAME,ADDRESS,CLUBNAME) VALUES('SANKET','NAGAR','FDGT');

INSERT INTO GAME_PLAYERS(GNAME,PNAME,COACH_NAME) VALUES('FOOTBALL','RAJU','GFOYTY');
INSERT INTO GAME_PLAYERS(GNAME,PNAME,COACH_NAME) VALUES('FOOTBALL','SANJU','TYUIFC');
INSERT INTO GAME_PLAYERS(GNAME,PNAME,COACH_NAME) VALUES('FOOTBALL','VIJAY','VMCNGF');
INSERT INTO GAME_PLAYERS(GNAME,PNAME,COACH_NAME) VALUES('CRICKET','RAJU','VMBNHJ');
INSERT INTO GAME_PLAYERS(GNAME,PNAME,COACH_NAME) VALUES('CRICKET','SANKET','VBNHJY');
INSERT INTO GAME_PLAYERS(GNAME,PNAME,COACH_NAME) VALUES('VOLLEYBALL','KEDAR','VCBGFC');
INSERT INTO GAME_PLAYERS(GNAME,PNAME,COACH_NAME) VALUES('VOLLEYBALL','VIJAY','VMBNHG');
INSERT INTO GAME_PLAYERS(GNAME,PNAME,COACH_NAME) VALUES('BASKETBALL','SIDDHESH','VPBNHG');
INSERT INTO GAME_PLAYERS(GNAME,PNAME,COACH_NAME) VALUES('BASKETBALL','SHOUNAK','EWRTYU');
INSERT INTO GAME_PLAYERS(GNAME,PNAME,COACH_NAME) VALUES('BASEBALL','SHUBHANKAR','WERTYY');
INSERT INTO GAME_PLAYERS(GNAME,PNAME,COACH_NAME) VALUES('BASEBALL','RAJU','CVDFGH');

SELECT * FROM GAME;
SELECT * FROM PLAYERS;
SELECT * FROM GAME_PLAYERS;

SELECT P.PNAME, COUNT(GP.GNAME) 
FROM PLAYERS P,GAME G, GAME_PLAYERS GP
WHERE P.PNAME = GP.PNAME AND G.GNAME = GP.GNAME 
GROUP BY P.PNAME HAVING COUNT(GP.GNAME)>2;  

SELECT G.GNAME, G.CAPTAIN_NAME
FROM GAME G, GAME_PLAYERS GP
WHERE G.GNAME = GP.GNAME 
GROUP BY G.GNAME HAVING COUNT(DISTINCT COACH_NAME)>2;

SELECT GNAME FROM GAME 
WHERE NO_OF_PLAYERS>5;

SELECT DISTINCT GP.COACH_NAME, GP.PNAME
FROM PLAYERS P, GAME_PLAYERS GP
WHERE P.PNAME = GP.PNAME;
