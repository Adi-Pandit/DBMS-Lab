USE cafy21573;

DROP TABLE BOOK_AUTHOR;
DROP TABLE AUTHOR;
DROP TABLE BOOK1;

CREATE TABLE BOOK1(BOOKNO INT PRIMARY KEY, BNAME VARCHAR(30), PUBNAME VARCHAR(30) NOT NULL);
CREATE TABLE AUTHOR(AUTHORNO INT PRIMARY KEY, AUTHOR_NAME VARCHAR(30) NOT NULL);
CREATE TABLE BOOK_AUTHOR(BOOKNO INT, FOREIGN KEY(BOOKNO) REFERENCES BOOK1(BOOKNO), AUTHORNO INT, FOREIGN KEY(AUTHORNO) REFERENCES AUTHOR(AUTHORNO), PUBYEAR INT);

DESC BOOK1;
DESC AUTHOR;
DESC BOOK_AUTHOR;

INSERT INTO BOOK1(BOOKNO, BNAME, PUBNAME) VALUES(101, 'DBMS', 'ABCD');
INSERT INTO BOOK1(BOOKNO, BNAME, PUBNAME) VALUES(102, 'PYTHON', 'DREAMLAND');
INSERT INTO BOOK1(BOOKNO, BNAME, PUBNAME) VALUES(103, 'OS', 'WILEY');
INSERT INTO BOOK1(BOOKNO, BNAME, PUBNAME) VALUES(104, 'C', 'BPB');
INSERT INTO BOOK1(BOOKNO, BNAME, PUBNAME) VALUES(105, 'JAVA', 'Tata McgrawHill');

INSERT INTO AUTHOR(AUTHORNO, AUTHOR_NAME) VALUES(201, 'KORTH'); 
INSERT INTO AUTHOR(AUTHORNO, AUTHOR_NAME) VALUES(202, 'NAGESHWARA RAO');
INSERT INTO AUTHOR(AUTHORNO, AUTHOR_NAME) VALUES(203, 'GALVIN');
INSERT INTO AUTHOR(AUTHORNO, AUTHOR_NAME) VALUES(204, 'KORTH');
INSERT INTO AUTHOR(AUTHORNO, AUTHOR_NAME) VALUES(205, 'E BALAGURUSWAMY');

INSERT INTO BOOK_AUTHOR(BOOKNO, AUTHORNO, PUBYEAR) VALUES(101, 201, 2019);
INSERT INTO BOOK_AUTHOR(BOOKNO, AUTHORNO, PUBYEAR) VALUES(102, 202, 1969);
INSERT INTO BOOK_AUTHOR(BOOKNO, AUTHORNO, PUBYEAR) VALUES(103, 203, 1974);
INSERT INTO BOOK_AUTHOR(BOOKNO, AUTHORNO, PUBYEAR) VALUES(104, 204, 1963);
INSERT INTO BOOK_AUTHOR(BOOKNO, AUTHORNO, PUBYEAR) VALUES(105, 205, 1980);

SELECT * FROM BOOK1;
SELECT * FROM AUTHOR;
SELECT * FROM BOOK_AUTHOR;

SELECT B.BNAME, BA.PUBYEAR FROM BOOK1 B, BOOK_AUTHOR BA 
WHERE B.BOOKNO = BA.BOOKNO ORDER BY PUBYEAR DESC;

SELECT BNAME FROM BOOK1 
WHERE PUBNAME = "Tata McgrawHill";

SELECT B.BNAME FROM BOOK1 B, AUTHOR A, BOOK_AUTHOR BA
WHERE B.BOOKNO = BA.BOOKNO AND A.AUTHORNO = BA.AUTHORNO AND AUTHOR_NAME = "KORTH";

SELECT B.BNAME, A.AUTHOR_NAME, B.PUBNAME FROM BOOK1 B, AUTHOR A, BOOK_AUTHOR BA
WHERE B.BOOKNO = BA.BOOKNO AND A.AUTHORNO = BA.AUTHORNO AND PUBYEAR = 2019;

